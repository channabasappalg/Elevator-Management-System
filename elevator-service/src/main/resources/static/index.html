<!DOCTYPE html>
<html>
<head>
    <title>Elevator Status</title>
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
    <style>
        body { font-family: sans-serif; }
        #elevators { display: flex; flex-wrap: wrap; gap: 20px; }
        .elevator { border: 1px solid #ccc; padding: 10px; width: 150px; }
        .elevator h3 { margin-top: 0; }
    </style>
</head>
<body>
    <h1>Real-Time Elevator Status</h1>
    <div id="elevators"></div>

    <script>
        var stompClient = null;

        function connect() {
            var socket = new SockJS('/ws-elevator');
            stompClient = Stomp.over(socket);
            stompClient.connect({}, function (frame) {
                console.log('Connected: ' + frame);
                stompClient.subscribe('/topic/elevator-status', function (message) {
                    showElevatorStatus(JSON.parse(message.body));
                });
            });
        }

        function showElevatorStatus(statuses) {
            const elevatorsDiv = document.getElementById('elevators');
            elevatorsDiv.innerHTML = ''; // Clear previous statuses
            statuses.forEach(elevator => {
                const elevatorDiv = document.createElement('div');
                elevatorDiv.classList.add('elevator');
                elevatorDiv.innerHTML = `
                    <h3>Elevator #${elevator.id}</h3>
                    <p>Floor: ${elevator.currentFloor}</p>
                    <p>Status: ${elevator.status}</p>
                    <p>Direction: ${elevator.direction}</p>
                    <p>Operational: ${elevator.operational}</p>
                `;
                elevatorsDiv.appendChild(elevatorDiv);
            });
        }

        connect();
    </script>
</body>
</html>